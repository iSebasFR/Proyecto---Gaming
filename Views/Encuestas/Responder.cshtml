@model Proyecto_Gaming.ViewModels.Surveys.TakeSurveyVM
@using Proyecto_Gaming.Models.Surveys

@{
    ViewData["Title"] = "Responder encuesta";
}

<h1 class="text-white mb-1">@Model.Title</h1>
@if (!string.IsNullOrWhiteSpace(Model.Description))
{
    <p class="text-muted mb-4">@Model.Description</p>
}

<form asp-action="Responder" method="post" class="card p-3" style="background:#151530;border:1px solid rgba(139,44,230,.3)">
    <input type="hidden" asp-for="SurveyId" />
    <div class="vstack gap-4">

        @for (int i = 0; i < Model.Questions.Count; i++)
        {
            var q = Model.Questions[i];
            <div class="p-3 rounded" style="background:#0f0f1f">
                <h6 class="text-white mb-3">@(i + 1). @q.Text</h6>

                @* Texto abierto *@
                @if (q.Type == QuestionType.OpenText)
                {
                    <textarea class="form-control" asp-for="Questions[@i].OpenAnswer" rows="3"
                              placeholder="Escribe tu respuesta..."></textarea>
                }
                @* Sí/No (asume 2 opciones) *@
                else if (q.Type == QuestionType.YesNo)
                {
                    <div class="form-check">
                        <input class="form-check-input" type="radio"
                               asp-for="Questions[@i].SelectedOptionId"
                               value="@q.Options.First().OptionId" id="q@i_opt1" />
                        <label class="form-check-label" for="q@i_opt1">@q.Options.First().Text</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio"
                               asp-for="Questions[@i].SelectedOptionId"
                               value="@q.Options.Last().OptionId" id="q@i_opt2" />
                        <label class="form-check-label" for="q@i_opt2">@q.Options.Last().Text</label>
                    </div>
                }
                @* Opción múltiple *@
                else if (q.Type == QuestionType.MultipleChoice)
                {
                    @for (var j = 0; j < q.Options.Count; j++)
                    {
                        var opt = q.Options[j];
                        <div class="form-check">
                            <input class="form-check-input" type="radio"
                                   asp-for="Questions[@i].SelectedOptionId"
                                   value="@opt.OptionId" id="q@i_opt@j" />
                            <label class="form-check-label" for="q@i_opt@j">@opt.Text</label>
                        </div>
                    }
                }

                <input type="hidden" asp-for="Questions[@i].QuestionId" />
                <input type="hidden" asp-for="Questions[@i].Type" />
            </div>
        }

        <div>
            <button type="submit" class="btn btn-gradient px-4">Enviar encuesta</button>
            <a asp-action="Index" class="btn btn-outline-light ms-2">Cancelar</a>
        </div>
    </div>
</form>

<style>
.btn-gradient{
    background: linear-gradient(135deg,#8b2ce6,#2c5be6);
    border:none;color:#fff;font-weight:600;
}
</style>
